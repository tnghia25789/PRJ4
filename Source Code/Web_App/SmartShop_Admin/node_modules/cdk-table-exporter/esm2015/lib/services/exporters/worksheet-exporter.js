import { __awaiter } from "tslib";
import { FileExporter } from './file-exporter';
/**
 * An angular service class that is used to create files out of json object arrays.
 */
export class WorksheetExporter extends FileExporter {
    constructor(sheetJsHelper) {
        super();
        this.sheetJsHelper = sheetJsHelper;
    }
    createContent(rows, options) {
        return __awaiter(this, void 0, void 0, function* () {
            const workSheet = (yield this.sheetJsHelper.getXlsx()).utils.json_to_sheet(rows, {
                skipHeader: true // we don't want to see object properties as our headers
            });
            return yield this.workSheetToContent(workSheet, options);
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya3NoZWV0LWV4cG9ydGVyLmpzIiwic291cmNlUm9vdCI6IkQ6L2FuZ3VsYXJfd29ya3NwYWNlL25nLW1hdGVyaWFsLWV4dGVuc2lvbnMvcHJvamVjdHMvY2RrLXRhYmxlLWV4cG9ydGVyL3NyYy8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy9leHBvcnRlcnMvd29ya3NoZWV0LWV4cG9ydGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFL0M7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLGlCQUFxQixTQUFRLFlBQWU7SUFFaEUsWUFBc0IsYUFBbUM7UUFDdkQsS0FBSyxFQUFFLENBQUM7UUFEWSxrQkFBYSxHQUFiLGFBQWEsQ0FBc0I7SUFFekQsQ0FBQztJQUVZLGFBQWEsQ0FBQyxJQUFnQixFQUFFLE9BQVc7O1lBQ3RELE1BQU0sU0FBUyxHQUFlLENBQUMsTUFBTSxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUU7Z0JBQzNGLFVBQVUsRUFBRSxJQUFJLENBQUMsd0RBQXdEO2FBQzFFLENBQUMsQ0FBQztZQUNILE9BQU8sTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzNELENBQUM7S0FBQTtDQUlGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV29ya1NoZWV0IH0gZnJvbSAneGxzeCc7XHJcbmltcG9ydCB7IE1pbWUgfSBmcm9tICcuLi8uLi9taW1lJztcclxuaW1wb3J0IHsgRmlsZUV4cG9ydGVyIH0gZnJvbSAnLi9maWxlLWV4cG9ydGVyJztcclxuaW1wb3J0IHsgU2hlZXRqc0hlbHBlclNlcnZpY2UgfSBmcm9tICcuLi9zaGVldGpzLWhlbHBlci5zZXJ2aWNlJztcclxuLyoqXHJcbiAqIEFuIGFuZ3VsYXIgc2VydmljZSBjbGFzcyB0aGF0IGlzIHVzZWQgdG8gY3JlYXRlIGZpbGVzIG91dCBvZiBqc29uIG9iamVjdCBhcnJheXMuXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgV29ya3NoZWV0RXhwb3J0ZXI8VD4gZXh0ZW5kcyBGaWxlRXhwb3J0ZXI8VD4ge1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgc2hlZXRKc0hlbHBlcjogU2hlZXRqc0hlbHBlclNlcnZpY2UpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYXN5bmMgY3JlYXRlQ29udGVudChyb3dzOiBBcnJheTxhbnk+LCBvcHRpb25zPzogVCk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCB3b3JrU2hlZXQ6IFdvcmtTaGVldCA9ICAoYXdhaXQgdGhpcy5zaGVldEpzSGVscGVyLmdldFhsc3goKSkudXRpbHMuanNvbl90b19zaGVldChyb3dzLCB7XHJcbiAgICAgIHNraXBIZWFkZXI6IHRydWUgLy8gd2UgZG9uJ3Qgd2FudCB0byBzZWUgb2JqZWN0IHByb3BlcnRpZXMgYXMgb3VyIGhlYWRlcnNcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMud29ya1NoZWV0VG9Db250ZW50KHdvcmtTaGVldCwgb3B0aW9ucyk7XHJcbiAgfVxyXG4gIHB1YmxpYyBhYnN0cmFjdCB3b3JrU2hlZXRUb0NvbnRlbnQod29ya1NoZWV0OiBXb3JrU2hlZXQsIG9wdGlvbnM/OiBUKTogUHJvbWlzZTxhbnk+O1xyXG4gIHB1YmxpYyBhYnN0cmFjdCBnZXRNaW1lVHlwZSgpOiBNaW1lO1xyXG5cclxufVxyXG4iXX0=